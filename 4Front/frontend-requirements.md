# Требования к Frontend приложению для API Registry

## Обзор проекта

API Registry - это микросервис для управления реестром API, их зависимостями, окружениями и генерации OpenAPI спецификаций. Frontend приложение должно предоставить удобный интерфейс для работы с этим API с акцентом на клавиатурную навигацию.

## Технические требования

### Базовые требования

- **Фреймворк**: React 18+ с TypeScript
- **Стилизация**: CSS-in-JS (styled-components) или Tailwind CSS
- **Состояние**: Redux Toolkit или Zustand
- **HTTP клиент**: Axios или Fetch API
- **Роутинг**: React Router v6
- **Формы**: React Hook Form с валидацией (Yup/Zod)
- **UI компоненты**: Headless UI или собственные компоненты
- **Иконки**: Heroicons или Lucide React

### Требования к клавиатурной навигации

**КРИТИЧЕСКИ ВАЖНО**: Приложение должно быть полностью доступно с клавиатуры. Минимальное использование мыши/трекпада.

#### Обязательные горячие клавиши:

- **Глобальная навигация**:
  - `Ctrl/Cmd + K` - Глобальный поиск/командная палитра
  - `Ctrl/Cmd + /` - Показать справку по горячим клавишам
  - `Ctrl/Cmd + 1-9` - Переключение между основными разделами
  - `Esc` - Закрыть модальные окна/выйти из режимов

- **Навигация по спискам**:
  - `↑/↓` - Навигация по элементам списка
  - `Enter` - Выбор/открытие элемента
  - `Space` - Выделение элемента (множественный выбор)
  - `Ctrl/Cmd + A` - Выделить все
  - `Delete` - Удалить выбранные элементы

- **Формы**:
  - `Tab/Shift+Tab` - Навигация между полями
  - `Ctrl/Cmd + Enter` - Сохранить форму
  - `Ctrl/Cmd + S` - Быстрое сохранение
  - `Esc` - Отменить изменения

- **Редактирование**:
  - `Ctrl/Cmd + Z` - Отменить
  - `Ctrl/Cmd + Y` - Повторить
  - `Ctrl/Cmd + C/V` - Копировать/Вставить
  - `F2` - Переименовать

#### Визуальные индикаторы:
- Четкий focus ring для всех интерактивных элементов
- Подсветка активного элемента
- Breadcrumbs для понимания текущего местоположения
- Статус-бар с подсказками по доступным действиям

## Функциональные требования

### 1. Управление сервисами

#### 1.1 Список сервисов
- **URL**: `/services`
- **Функции**:
  - Отображение всех сервисов в виде таблицы/карточек
  - Фильтрация по типу сервиса, владельцу, тегам
  - Поиск по названию и описанию
  - Сортировка по дате создания, названию, владельцу
  - Пагинация (если много сервисов)

#### 1.2 Создание сервиса
- **URL**: `/services/new`
- **Поля формы**:
  - Название сервиса (обязательное, до 150 символов)
  - Описание (опциональное)
  - Владелец (обязательное, до 120 символов)
  - Теги (массив строк)
  - Тип сервиса (APPLICATION, LIBRARY, JOB, PROXY)
  - Поддержка БД (checkbox)
  - Прокси (checkbox)

#### 1.3 Просмотр сервиса
- **URL**: `/services/:serviceId`
- **Разделы**:
  - Основная информация
  - Окружения (dev, test, prod)
  - Эндпоинты
  - Зависимости
  - Связи с БД
  - Граф зависимостей (визуализация)

#### 1.4 Редактирование сервиса
- **URL**: `/services/:serviceId/edit`
- Inline редактирование основных полей
- Модальные окна для сложных операций

### 2. Управление окружениями

#### 2.1 Создание/редактирование окружения
- **Поля**:
  - Код окружения (dev, test, prod, custom)
  - Отображаемое имя
  - Хост (URL)
  - Конфигурация (JSON):
    - Таймаут (мс)
    - Количество повторов
    - Переопределения для downstream сервисов
  - Статус (ACTIVE, INACTIVE)

### 3. Управление эндпоинтами

#### 3.1 Список эндпоинтов сервиса
- **URL**: `/services/:serviceId/endpoints`
- Группировка по HTTP методам
- Фильтрация по методу, пути
- Поиск по описанию

#### 3.2 Создание эндпоинта
- **URL**: `/services/:serviceId/endpoints/new`
- **Поля**:
  - HTTP метод (GET, POST, PUT, PATCH, DELETE, HEAD, OPTIONS)
  - Путь (обязательное)
  - Описание (обязательное)
  - Схема запроса (JSON Schema)
  - Схемы ответов (JSON Schema для разных статус-кодов)
  - Настройки аутентификации
  - Rate limiting
  - Метаданные
  - Вызовы других сервисов
  - Операции с БД

#### 3.3 Редактор JSON Schema
- Визуальный редактор с подсветкой синтаксиса
- Валидация JSON Schema
- Предпросмотр сгенерированной документации

### 4. Управление зависимостями

#### 4.1 Граф зависимостей
- **URL**: `/services/:serviceId/dependencies`
- Интерактивная визуализация графа
- Фильтры по направлению (upstream/downstream)
- Ограничение глубины
- Экспорт в различные форматы

#### 4.2 Добавление зависимости
- Поиск и выбор целевого сервиса
- Настройка типа зависимости
- Конфигурация подключения

### 5. Управление базами данных

#### 5.1 Реестр БД
- **URL**: `/databases`
- Список всех зарегистрированных БД
- Создание новых записей БД

#### 5.2 Связывание сервиса с БД
- Выбор БД из реестра
- Указание схемы
- Переопределение настроек подключения для окружения

### 6. Генерация OpenAPI

#### 6.1 Генератор спецификации
- **URL**: `/services/:serviceId/openapi`
- Выбор окружения для генерации
- Предпросмотр сгенерированной спецификации
- Экспорт в YAML/JSON
- Интеграция с Swagger UI

### 7. Дополнительные функции

#### 7.1 Глобальный поиск
- **Горячая клавиша**: `Ctrl/Cmd + K`
- Поиск по всем сущностям:
  - Сервисы (по названию, описанию, тегам)
  - Эндпоинты (по пути, описанию)
  - БД (по названию)
- Быстрые действия (создать сервис, перейти к разделу)

#### 7.2 Командная палитра
- Быстрый доступ ко всем действиям
- Контекстные команды в зависимости от текущей страницы
- История команд

#### 7.3 Уведомления и статусы
- Toast уведомления для операций
- Индикаторы загрузки
- Статус подключения к API
- Валидация форм в реальном времени

## UI/UX требования

### Дизайн-система

#### Цветовая схема
- Поддержка светлой и темной темы
- Переключение по `Ctrl/Cmd + Shift + T`
- Высокий контраст для accessibility

#### Типографика
- Четкая иерархия заголовков
- Моноширинный шрифт для кода и JSON
- Читаемые размеры шрифтов

#### Компоненты
- Консистентные отступы и размеры
- Единый стиль кнопок, полей ввода
- Модальные окна с backdrop
- Dropdown меню с клавиатурной навигацией

### Адаптивность
- Desktop-first подход (основная аудитория - разработчики)
- Минимальная ширина: 1200px
- Поддержка больших мониторов (до 4K)

### Производительность
- Ленивая загрузка компонентов
- Виртуализация больших списков
- Кэширование API запросов
- Оптимистичные обновления UI

## API интеграция

### Базовый URL
```
http://localhost:8080/api/v1
```

### Основные эндпоинты

#### Сервисы
- `GET /services` - Список сервисов
- `POST /services` - Создание сервиса
- `GET /services/{serviceId}` - Получение сервиса
- `PATCH /services/{serviceId}` - Обновление сервиса
- `DELETE /services/{serviceId}` - Удаление сервиса

#### Окружения
- `PUT /services/{serviceId}/environments/{envCode}` - Создание/обновление окружения
- `DELETE /services/{serviceId}/environments/{envCode}` - Удаление окружения

#### Эндпоинты
- `POST /services/{serviceId}/endpoints` - Создание эндпоинта
- `PATCH /services/{serviceId}/endpoints/{endpointId}` - Обновление эндпоинта
- `DELETE /services/{serviceId}/endpoints/{endpointId}` - Удаление эндпоинта

#### Зависимости
- `POST /services/{serviceId}/dependencies` - Добавление зависимости
- `DELETE /services/{serviceId}/dependencies/{dependencyId}` - Удаление зависимости
- `GET /services/{serviceId}/dependencies?direction=downstream&depth=3` - Граф зависимостей

#### Базы данных
- `GET /databases` - Список БД
- `POST /databases` - Регистрация БД
- `POST /services/{serviceId}/databases` - Связывание с БД
- `DELETE /services/{serviceId}/databases/{linkId}` - Удаление связи с БД

#### OpenAPI
- `POST /services/{serviceId}/generate-openapi?env={envCode}` - Генерация спецификации

### Обработка ошибок
- Централизованная обработка HTTP ошибок
- Пользовательские сообщения об ошибках
- Retry механизм для сетевых ошибок
- Fallback UI для критических ошибок

### Типы данных

#### Service
```typescript
interface Service {
  serviceId: string;
  name: string;
  description?: string;
  owner: string;
  tags: string[];
  serviceType: 'APPLICATION' | 'LIBRARY' | 'JOB' | 'PROXY';
  supportsDatabase: boolean;
  proxy: boolean;
  createdAt: string;
  updatedAt: string;
  environments?: ServiceEnvironment[];
}
```

#### ServiceEnvironment
```typescript
interface ServiceEnvironment {
  environmentId: string;
  serviceId: string;
  code: string;
  displayName: string;
  host: string;
  config?: {
    timeoutMs?: number;
    retries?: number;
    downstreamOverrides?: Record<string, string>;
  };
  status: 'ACTIVE' | 'INACTIVE';
  createdAt: string;
  updatedAt: string;
}
```

#### Endpoint
```typescript
interface Endpoint {
  endpointId: string;
  serviceId: string;
  method: 'GET' | 'POST' | 'PUT' | 'PATCH' | 'DELETE' | 'HEAD' | 'OPTIONS';
  path: string;
  summary: string;
  requestSchema?: Record<string, any>;
  responseSchemas?: Record<string, any>;
  auth?: Record<string, any>;
  rateLimit?: Record<string, any>;
  metadata?: Record<string, any>;
  calls?: EndpointCall[];
  databases?: EndpointDatabase[];
  createdAt: string;
  updatedAt: string;
}
```

## Требования к тестированию

### Unit тесты
- Покрытие всех компонентов
- Тестирование хуков и утилит
- Мокирование API вызовов

### Integration тесты
- Тестирование пользовательских сценариев
- Проверка клавиатурной навигации
- Тестирование форм и валидации

### E2E тесты
- Критические пользовательские пути
- Тестирование в разных браузерах
- Проверка accessibility

## Требования к accessibility

- WCAG 2.1 AA соответствие
- Screen reader поддержка
- Высокий контраст
- Клавиатурная навигация (100% покрытие)
- Семантическая разметка HTML
- ARIA атрибуты где необходимо

## Требования к развертыванию

- Docker контейнер
- Nginx для статических файлов
- Environment variables для конфигурации
- Health check эндпоинт
- Логирование ошибок
- Метрики производительности

## Безопасность

- Content Security Policy
- XSS защита
- CSRF токены (если нужна аутентификация)
- Валидация всех пользовательских вводов
- Безопасное хранение токенов (если есть аутентификация)